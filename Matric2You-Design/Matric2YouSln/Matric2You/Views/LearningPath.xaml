<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
 xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
 xmlns:helpers="clr-namespace:Matric2You.Helpers"
 x:Class="Matric2You.Views.LearningPath"
 Title="Progress Overview">
 <ContentPage.Resources>
 <ResourceDictionary>
 <helpers:PercentTo0to1Converter x:Key="PercentTo0to1Converter" />
 </ResourceDictionary>
 </ContentPage.Resources>

 <RefreshView IsRefreshing="{Binding IsBusy}" Command="{Binding RefreshCommand}">
 <ScrollView>
 <VerticalStackLayout Padding="16" Spacing="16">

 <!-- Header: user name -->
 <Label Text="{Binding UserName, StringFormat='Welcome, {0}'}" FontAttributes="Bold" FontSize="22" />

 <!-- Dashboard blocks -->
 <Grid ColumnDefinitions="*,*" RowDefinitions="Auto,Auto" ColumnSpacing="12" RowSpacing="12">
 <Border Grid.Row="0" Grid.Column="0" Padding="12" StrokeThickness="0" Background="{AppThemeBinding Light=#F2F2F2, Dark=#222}">
 <VerticalStackLayout>
 <Label Text="Total Activities" FontAttributes="Bold" />
 <Label Text="{Binding TotalActivities}" FontSize="18" />
 </VerticalStackLayout>
 </Border>
 <Border Grid.Row="0" Grid.Column="1" Padding="12" StrokeThickness="0" Background="{AppThemeBinding Light=#F2F2F2, Dark=#222}">
 <VerticalStackLayout>
 <Label Text="Completed" FontAttributes="Bold" />
 <Label Text="{Binding CompletedActivities}" FontSize="18" />
 </VerticalStackLayout>
 </Border>
 <Border Grid.Row="1" Grid.Column="0" Padding="12" StrokeThickness="0" Background="{AppThemeBinding Light=#F2F2F2, Dark=#222}">
 <VerticalStackLayout>
 <Label Text="Total Rewards" FontAttributes="Bold" />
 <Label Text="{Binding TotalRewards}" FontSize="18" />
 </VerticalStackLayout>
 </Border>
 <Border Grid.Row="1" Grid.Column="1" Padding="12" StrokeThickness="0" Background="{AppThemeBinding Light=#F2F2F2, Dark=#222}">
 <VerticalStackLayout>
 <Label Text="Average Test Score" FontAttributes="Bold" />
 <Label Text="{Binding AverageScore, StringFormat='{0:0.#}%'}" FontSize="18" />
 </VerticalStackLayout>
 </Border>
 </Grid>

 <!-- Mathematics Tests -->
 <Label Text="Mathematics Tests" FontAttributes="Bold" FontSize="20" />
 <Grid ColumnDefinitions="*,*,*" ColumnSpacing="12">
 <!-- Practice -->
 <VerticalStackLayout Grid.Column="0">
 <Button Text="Practice" Clicked="OnPracticeClicked" />
 <Label Text="{Binding PracticeProgress.ScorePercent, StringFormat='Score: {0:0.#}%'}" HorizontalTextAlignment="Center" />
 <Label HorizontalTextAlignment="Center">
 <Label.FormattedText>
 <FormattedString>
 <Span Text="Answered: " />
 <Span Text="{Binding PracticeProgress.Answered}" />
 <Span Text="/" />
 <Span Text="{Binding PracticeProgress.TotalQuestions}" />
 </FormattedString>
 </Label.FormattedText>
 </Label>
 <ProgressBar Progress="{Binding PracticeProgress.ScorePercent, Converter={StaticResource PercentTo0to1Converter}}" />
 </VerticalStackLayout>

 <!-- Quiz -->
 <VerticalStackLayout Grid.Column="1">
 <Button Text="Quiz" Clicked="OnQuizClicked" />
 <Label Text="{Binding QuizProgress.ScorePercent, StringFormat='Score: {0:0.#}%'}" HorizontalTextAlignment="Center" />
 <Label HorizontalTextAlignment="Center">
 <Label.FormattedText>
 <FormattedString>
 <Span Text="Answered: " />
 <Span Text="{Binding QuizProgress.Answered}" />
 <Span Text="/" />
 <Span Text="{Binding QuizProgress.TotalQuestions}" />
 </FormattedString>
 </Label.FormattedText>
 </Label>
 <ProgressBar Progress="{Binding QuizProgress.ScorePercent, Converter={StaticResource PercentTo0to1Converter}}" />
 </VerticalStackLayout>

 <!-- Exam -->
 <VerticalStackLayout Grid.Column="2">
 <Button Text="Exam" Clicked="OnExamClicked" />
 <Label Text="{Binding ExamProgress.ScorePercent, StringFormat='Score: {0:0.#}%'}" HorizontalTextAlignment="Center" />
 <Label HorizontalTextAlignment="Center">
 <Label.FormattedText>
 <FormattedString>
 <Span Text="Answered: " />
 <Span Text="{Binding ExamProgress.Answered}" />
 <Span Text="/" />
 <Span Text="{Binding ExamProgress.TotalQuestions}" />
 </FormattedString>
 </Label.FormattedText>
 </Label>
 <ProgressBar Progress="{Binding ExamProgress.ScorePercent, Converter={StaticResource PercentTo0to1Converter}}" />
 </VerticalStackLayout>
 </Grid>

 <!-- Learning Content -->
 <Label Text="Learning Content" FontAttributes="Bold" FontSize="20" />
 <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
 <VerticalStackLayout Grid.Column="0" Spacing="4">
 <Button Text="Algebra" Clicked="OnAlgebraClicked" />
 <Label Text="Foundations: variables, equations, factoring." TextColor="Gray" />
 <ProgressBar Progress="{Binding AlgebraStudy.CompletionPercent, Converter={StaticResource PercentTo0to1Converter}}" />
 <Label Text="{Binding AlgebraStudy.CompletionPercent, StringFormat='{0:0.#}% complete'}" FontSize="12" />
 </VerticalStackLayout>
 <VerticalStackLayout Grid.Column="1" Spacing="4">
 <Button Text="Geometry" Clicked="OnGeometryClicked" />
 <Label Text="Angles, triangles, area, circles." TextColor="Gray" />
 <ProgressBar Progress="{Binding GeometryStudy.CompletionPercent, Converter={StaticResource PercentTo0to1Converter}}" />
 <Label Text="{Binding GeometryStudy.CompletionPercent, StringFormat='{0:0.#}% complete'}" FontSize="12" />
 </VerticalStackLayout>
 </Grid>

 </VerticalStackLayout>
 </ScrollView>
 </RefreshView>
</ContentPage>